# 네이버 뉴스 댓글 분석 시스템 설계서

## 1. 프로젝트 개요

### 1.1 목표
- 특정 키워드와 관련된 네이버 뉴스를 수집하고, 해당 뉴스의 댓글을 크롤링하여 여론을 분석합니다.
- 수집된 데이터를 통합 관리하고 감성 분석 및 키워드 추출을 통해 인사이트를 도출합니다.

### 1.2 주요 특징
- **키워드 기반 수집**: 사용자 입력 키워드에 따른 뉴스 검색 및 댓글 수집.
- **데이터 통합**: 기존 유튜브 댓글 분석 프로젝트(`Opinion_Analysis`)와 동일한 데이터 구조를 사용하여 데이터 호환성 확보.
- **감성 분석**: BERT 모델과 LLM(DeepSeek 등)을 결합한 하이브리드 감성 분석.
- **키워드 추출**: 댓글 내 핵심 키워드 추출 및 시각화 준비.

## 2. 시스템 아키텍처

### 2.1 구성 모듈
1. **Collector (수집기)**: 네이버 뉴스 검색 API 또는 크롤링을 통해 뉴스 URL을 확보하고, 댓글 데이터를 수집.
2. **Database (저장소)**: Supabase를 사용하여 수집된 댓글 및 분석 결과 저장.
3. **Analyzer (분석기)**:
   - **NLP Engine**: 맞춤법 교정, 형태소 분석, 키워드 추출.
   - **Sentiment Engine**: BERT 및 LLM을 활용한 다각도 감성 분석.
4. **Config (설정)**: API 키, DB 연결 정보, 환경 변수 관리.

## 3. 데이터베이스 설계

### 3.1 테이블 정의 (`naver_news_comments`)
기존 유튜브 댓글 테이블 스키마와 최대한 호환되도록 구성합니다.

| 필드명 | 타입 | 설명 |
| :--- | :--- | :--- |
| `comment_id` | `TEXT` | 댓글 고유 ID (PK) |
| `news_id` | `TEXT` | 뉴스 기사 ID (기존 `video_id` 대응) |
| `author` | `TEXT` | 작성자 (마스킹된 아이디) |
| `content` | `TEXT` | 댓글 내용 |
| `likes` | `INTEGER` | 공감 수 |
| `dislikes` | `INTEGER` | 비공감 수 (네이버 뉴스 전용 추가 가능) |
| `published_at` | `TIMESTAMP` | 댓글 작성 시간 |
| `sentiment_label` | `INTEGER` | BERT 분석 결과 (0:긍정, 1:부정, 2:중립) |
| `sentiment_score` | `FLOAT` | BERT 분석 확신도 |
| `llm_sentiment` | `INTEGER` | LLM 분석 결과 |
| `keywords` | `TEXT[]` | 핵심 키워드 리스트 |
| `created_at` | `TIMESTAMP` | 데이터 생성 시간 |

## 4. 상세 기능 설계

### 4.1 크롤링 전략
- **뉴스 검색**: 네이버 검색 API 또는 BeautifulSoup을 이용한 정적 크롤링으로 뉴스 링크 수집.
- **댓글 수집**: 
  - 네이버 뉴스는 댓글이 동적으로 로딩되므로, `Selenium` 또는 `Playwright` 사용 검토.
  - 가능한 경우 네이버 뉴스 댓글 API 직접 호출 방식 시도 (정적 크롤링 선호 정책 반영).

### 4.2 텍스트 분석 프로세스
1. **전처리**: 이모지 제거, 특수문자 정제, 맞춤법 교정 (`et5-typos-corrector` 등 활용).
2. **키워드 추출**: `Konlpy` 또는 `Okt`를 활용한 형태소 분석 후 명사 위주 추출.
3. **감성 분석**:
   - 1차: BERT 기반 모델로 긍정/부정/중립 자동 분류.
   - 2차: LLM(DeepSeek)을 활용하여 맥락에 따른 정밀 분석 및 검증.

## 5. 프로젝트 디렉토리 구조

```text
naver_news_comment_cr/
├── config/             # 환경 설정 및 API 키 관리
├── database/           # DB 스키마 및 연결 모듈
├── src/
│   ├── collector/      # 뉴스 및 댓글 수집 스크립트
│   ├── analyzer/       # NLP 및 감성 분석 로직
│   └── utils/          # 공통 유틸리티 (로깅, 정규화 등)
├── scripts/            # 실행 자동화 스크립트
├── docs/               # 설계서 및 매뉴얼
├── AGENT.md            # 에이전트 가이드
└── 설계서.md            # 본 문서
```

## 6. 기술 스택
- **Language**: Python 3.12
- **Crawling**: BeautifulSoup, Selenium/Playwright
- **Database**: Supabase (PostgreSQL)
- **AI/NLP**: PyTorch, HuggingFace Transformers (BERT), DeepSeek API (LLM)
- **Environment**: Terminal-based (MacOS)
