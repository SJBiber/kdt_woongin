# 구현 계획: 유튜브 정밀 여론 분석 시스템 (분리형 파이프라인 구조)

이 프로젝트는 대중적인 유튜버의 특정 사건 전후 여론 변화를 정밀하게 추적하기 위해 수집, 정제, 분석 과정을 독립적인 프로그램으로 분리하여 효율성을 극대화한 시스템입니다.

## 1. 전용 프로그램 구조 (4-Step Pipeline)
데이터 분석의 병목 현상을 해결하기 위해 공정을 4단계로 분리하였습니다.

1.  **`1_collect_data.py`**: 유튜브 URL(`youtube_link.txt`)을 순회하며 원본 댓글 수집 및 DB 저장.
2.  **`2_normalize_text.py`**: 수집된 원본 텍스트에 대해 특수문자 제거 및 키워드 추출 수행 (**초고속 처리**).
3.  **`3_local_analysis.py`**: 정규화된 텍스트 기반으로 빠르게 로컬 BERT(KoELECTRA) 감성 분석 수행 (라벨링 가이드 적용).
4.  **`4_llm_analysis.py`**: DeepSeek-V3 LLM을 활용하여 날짜 맥락이 포함된 최종 정밀 감정 라벨링 단계 (API 기반).

## 2. 주요 분석 파이프라인
*   **수집 (Collection)**: `youtube-comment-downloader` 기반 멀티 쓰레드 지향 수집.
*   **정제 (Normalization)**: 
    *   **특수문자 제거**: 정규표현식 기반 고속 처리
    *   **키워드 추출**: Kiwi (kiwipiepy) 형태소 분석기 + 500개+ 불용어 필터링
    *   **사용자 사전 등록**: 복합어/고유명사 분리 방지 (예: "백종원", "이재명" 등 인명·브랜드명 보호)
    *   **성능**: 50개당 0.3초 (초고속 처리)
    *   **옵션**: ET5 맞춤법 교정 (필요 시 활성화 가능, 배치 처리 지원)
*   **하이브리드 분석 (Hybrid)**: 
    *   **Local BERT**: 6종 감정(Support, Anger, Neutral, Disappointment, Sarcasm, Inquiry) 1차 분류.
    *   **DeepSeek LLM**: 1월 19일 사건 전후 날짜 맥락을 고려하여 '비꼼(Sarcasm)'과 '진심'을 최종 판별.
*   **시각화 (Visualization)**: Streamlit 대시보드를 통해 인사이트 제공.

## 3. 핵심 모듈 상세
*   **Corrector**: `analyzer/corrector.py` (ET5 기반, 배치 처리 + GPU 지원)
*   **NLP Engine**: `analyzer/nlp_engine.py` (Kiwi 기반, 500+ 불용어, 사용자 사전)
*   **Sentiment**: `analyzer/sentiment_analyzer.py` (KoELECTRA 기반)
*   **LLM Analyzer**: `analyzer/deepseek_analyzer.py` (DeepSeek-V3 기반)

## 4. 성능 최적화 (2026-01-22 적용)
### Phase 2 텍스트 정규화 최적화
- **배치 처리**: 50개 단위 처리 (8GB 메모리 최적화)
- **맞춤법 교정**: 비활성화 (속도 우선, 필요 시 재활성화)
- **불용어 확장**: 30개 → 500개+ (품질 대폭 향상)
- **성능 개선**: 233배 속도 향상 (70초 → 0.3초/50개)
- **처리량**: 시간당 약 600,000개 댓글 처리 가능

## 5. 데이터베이스 및 기술 스택
- **Database**: Supabase (PostgreSQL)
- **NLP**: KoELECTRA, ET5 (옵션, 비활성화 상태), Kiwi (kiwipiepy)
- **LLM**: DeepSeek API
- **UI**: Streamlit

## 6. Streamlit 대시보드 (5-Page 구성)
분석 결과를 직관적으로 탐색할 수 있는 5페이지 멀티 대시보드를 제공합니다.

1.  **전체_요약**: 전체 데이터 현황, 주요 지표 요약, 핵심 키워드 워드클라우드
2.  **감성_비교분석**: 인물 간 감성 분포 비교 (긍정/부정/중립 비율, 감정 6종 분류 결과)
3.  **추이_비교분석**: 시간축 기반 여론 변화 추이 비교 (사건 전후 감성 흐름 시각화)
4.  **상세_통계**: 영상별/날짜별 상세 통계 테이블 및 필터링
5.  **영상_트렌드**: 개별 영상 단위 트렌드 분석 및 댓글 키워드 변화 추적

## 7. 비교 분석 파이프라인 (백종원 비교 분석)
주 분석 대상 외에 **백종원** 관련 여론 데이터를 동일한 파이프라인으로 수집·분석하여 비교 기준점을 제공합니다.

*   동일한 4-Step 파이프라인 (수집 → 정제 → 로컬 감성 분석 → LLM 정밀 분석)을 적용
*   대시보드 내 감성_비교분석 및 추이_비교분석 페이지에서 두 인물의 여론을 나란히 비교
*   사건 전후 여론 반전 패턴, 감정 분포 차이 등 교차 인사이트 도출

