# 백종원 vs 임성근 여론 비교 분석 - 최종 검증 체크리스트

## ✅ 핵심 원칙: 임성근과 완전히 동일한 방식

### 📊 감정 분석 카테고리 (6가지, 0-5)
```
0: support (응원, 지지, 복귀 기대)
1: anger (분노, 욕설, 강한 적대감)
2: neutral (중립, 무의미한 나열)
3: disappointment (실망, 유감, 팬이었으나 돌아섬)
4: sarcasm (조롱, 비꼼, 반어법)
5: inquiry (질문, 정보 요청, 유저 간 분쟁)
```

**부정적 감정 = 1 + 3 + 4 (anger + disappointment + sarcasm)**

---

## 🔍 생성된 파일 검증

### ✅ 1. analyzer/deepseek_baek_jongwon_analyzer.py
- [x] 임성근 analyzer와 동일한 6가지 카테고리 사용
- [x] 백종원 논란 맥락 반영 (2025.02-03)
- [x] 날짜 기반 비꼼 판단 로직
- [x] 임성근 analyzer 구조 그대로 복사

### ✅ 2. 1_collect_baek_jongwon.py
- [x] collection_period 필드 추가 ('controversy' or 'current')
- [x] target_person 필드 추가 ('백종원')
- [x] upsert_baek_jongwon_comments() 메서드 사용

### ✅ 3. 2_normalize_baek_jongwon.py
- [x] 임성근과 동일한 NLPEngine 사용
- [x] 동일한 불용어 리스트 (500개+)
- [x] baek_jongwon_youtube_comments 테이블 사용

### ✅ 4. 3_local_analysis_baek_jongwon.py
- [x] 임성근과 동일한 SentimentAnalyzer 사용
- [x] 동일한 BERT 모델 (KoELECTRA)
- [x] baek_jongwon_youtube_comments 테이블 사용

### ✅ 5. 4_llm_analysis_baek_jongwon.py
- [x] DeepSeekBaekJongwonAnalyzer 사용 (백종원 전용)
- [x] 임성근과 동일한 6가지 카테고리 (0-5)
- [x] 동일한 배치 크기 (20개)
- [x] 동일한 유효성 검증 (0 <= val <= 5)

### ✅ 6. database/baek_jongwon_schema.sql
- [x] 임성근 테이블과 동일한 구조
- [x] llm_sentiment INTEGER (0-5)
- [x] collection_period 필드 추가
- [x] 코멘트에 6가지 카테고리 명시

### ✅ 7. database/supabase_client.py
- [x] upsert_baek_jongwon_comments() 메서드 추가
- [x] 기존 upsert_comments()와 동일한 로직

---

## 🎯 실행 전 최종 확인사항

### 1. Supabase 테이블 생성
```sql
-- baek_jongwon_schema.sql 실행 확인
SELECT COUNT(*) FROM baek_jongwon_youtube_comments;
-- 오류 없이 0 반환되면 OK
```

### 2. analyzer 모듈 확인
```bash
cd Opinion_Analysis
python3 -c "from analyzer.deepseek_baek_jongwon_analyzer import DeepSeekBaekJongwonAnalyzer; print('OK')"
```

### 3. .env 파일 확인
```bash
# DEEPSEEK_API_KEY 존재 확인
grep DEEPSEEK_API_KEY .env
```

### 4. 테스트 실행
```bash
# analyzer 테스트
cd Opinion_Analysis/analyzer
python3 deepseek_baek_jongwon_analyzer.py
# 결과: [4, 0, 1] 형태의 배열 출력되면 OK
```

---

## 📊 데이터 비교 방법

### 부정적 감정 비율 계산 (동일한 기준)
```sql
-- 백종원 논란 시기
SELECT 
    ROUND(100.0 * SUM(CASE WHEN llm_sentiment IN (1,3,4) THEN 1 ELSE 0 END) / COUNT(*), 2) as negative_ratio
FROM baek_jongwon_youtube_comments 
WHERE collection_period = 'controversy';

-- 백종원 현재
SELECT 
    ROUND(100.0 * SUM(CASE WHEN llm_sentiment IN (1,3,4) THEN 1 ELSE 0 END) / COUNT(*), 2) as negative_ratio
FROM baek_jongwon_youtube_comments 
WHERE collection_period = 'current';

-- 임성근 현재
SELECT 
    ROUND(100.0 * SUM(CASE WHEN llm_sentiment IN (1,3,4) THEN 1 ELSE 0 END) / COUNT(*), 2) as negative_ratio
FROM im_sung_gen_youtube_comments;
```

### 카테고리별 분포 비교
```sql
-- 3개 테이블 통합 비교
SELECT 
    '백종원_논란시' as target,
    llm_sentiment,
    COUNT(*) as count,
    ROUND(100.0 * COUNT(*) / SUM(COUNT(*)) OVER(), 2) as percentage
FROM baek_jongwon_youtube_comments 
WHERE collection_period = 'controversy'
GROUP BY llm_sentiment

UNION ALL

SELECT 
    '백종원_현재' as target,
    llm_sentiment,
    COUNT(*) as count,
    ROUND(100.0 * COUNT(*) / SUM(COUNT(*)) OVER(), 2) as percentage
FROM baek_jongwon_youtube_comments 
WHERE collection_period = 'current'
GROUP BY llm_sentiment

UNION ALL

SELECT 
    '임성근_현재' as target,
    llm_sentiment,
    COUNT(*) as count,
    ROUND(100.0 * COUNT(*) / SUM(COUNT(*)) OVER(), 2) as percentage
FROM im_sung_gen_youtube_comments
GROUP BY llm_sentiment

ORDER BY target, llm_sentiment;
```

---

## ⚠️ 주의사항

### 절대 하지 말아야 할 것
1. ❌ 임성근 데이터 재분석 (이미 완료된 509개 데이터 유지)
2. ❌ 카테고리 개수 변경 (반드시 6개 유지)
3. ❌ 카테고리 번호 변경 (0-5 고정)
4. ❌ 부정적 감정 정의 변경 (1,3,4 고정)

### 반드시 해야 할 것
1. ✅ 백종원 analyzer는 별도 파일 사용
2. ✅ 백종원 테이블은 별도 테이블 사용
3. ✅ 동일한 분석 파이프라인 적용
4. ✅ 동일한 카테고리 정의 사용

---

## 🚀 실행 순서 (최종)

```bash
cd Opinion_Analysis

# 1. 백종원 영상 URL 추가
# baek_jongwon_link.txt 파일 편집

# 2. Supabase 테이블 생성
# Supabase SQL Editor에서 database/baek_jongwon_schema.sql 실행

# 3. 논란 시기 데이터 수집
python3 1_collect_baek_jongwon.py --period controversy --limit 500

# 4. 현재 시기 데이터 수집
python3 1_collect_baek_jongwon.py --period current --limit 500

# 5. 텍스트 정규화
python3 2_normalize_baek_jongwon.py

# 6. BERT 감성 분석
python3 3_local_analysis_baek_jongwon.py

# 7. LLM 정밀 분석
python3 4_llm_analysis_baek_jongwon.py

# 8. 결과 확인
# Supabase에서 위의 SQL 쿼리 실행
```

---

## 📝 최종 확인

### 모든 파일이 올바르게 생성되었는지 확인
```bash
cd Opinion_Analysis

# analyzer
ls -la analyzer/deepseek_baek_jongwon_analyzer.py

# 수집 및 분석 스크립트
ls -la 1_collect_baek_jongwon.py
ls -la 2_normalize_baek_jongwon.py
ls -la 3_local_analysis_baek_jongwon.py
ls -la 4_llm_analysis_baek_jongwon.py

# 데이터베이스
ls -la database/baek_jongwon_schema.sql
ls -la database/supabase_client.py

# URL 목록
ls -la baek_jongwon_link.txt
```

---

## ✅ 검증 완료 체크리스트

- [ ] analyzer/deepseek_baek_jongwon_analyzer.py 생성 확인
- [ ] 6가지 카테고리 (0-5) 사용 확인
- [ ] 백종원 논란 맥락 (2025.02-03) 반영 확인
- [ ] 임성근과 동일한 부정적 감정 정의 (1,3,4) 확인
- [ ] Supabase 테이블 스키마 확인
- [ ] 모든 스크립트 파일 생성 확인
- [ ] 문서 업데이트 확인

**모든 항목이 체크되면 실행 준비 완료!** 🎉
